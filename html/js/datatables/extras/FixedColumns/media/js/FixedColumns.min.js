/*
 * File:        FixedColumns.nightly.min.js
 * Version:     2.5.0.dev
 * Author:      Allan Jardine (www.sprymedia.co.uk)
 * Info:        www.datatables.net
 * 
 * Copyright 2008-2012 Allan Jardine, all rights reserved.
 *
 * This source file is free software, under either the GPL v2 license or a
 * BSD style license, available at:
 *   http://datatables.net/license_gpl2
 *   http://datatables.net/license_bsd
 * 
 * This source file is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 */
/*
     GPL v2 or BSD 3 point style
*/
var FixedColumns;
(function(d,t){FixedColumns=function(a,b){var c=this;if(!this instanceof FixedColumns)alert("FixedColumns warning: FixedColumns must be initialised with the 'new' keyword.");else{if(typeof b=="undefined")b={};this.s={dt:a.fnSettings(),iTableColumns:a.fnSettings().aoColumns.length,aiOuterWidths:[],aiInnerWidths:[],bOldIE:d.browser.msie&&(d.browser.version=="6.0"||d.browser.version=="7.0")};this.dom={scroller:null,header:null,body:null,footer:null,grid:{wrapper:null,dt:null,left:{wrapper:null,head:null,
body:null,foot:null},right:{wrapper:null,head:null,body:null,foot:null}},clone:{left:{header:null,body:null,footer:null},right:{header:null,body:null,footer:null}}};this.s.dt.oFixedColumns=this;this.s.dt._bInitComplete?this._fnConstruct(b):this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoInitComplete",function(){c._fnConstruct(b)},"FixedColumns")}};FixedColumns.prototype={fnUpdate:function(){this._fnDraw(true)},fnRedrawLayout:function(){this._fnColCalc();this._fnGridLayout();this.fnUpdate()},fnRecalculateHeight:function(a){a._DTTC_iHeight=
null;a.style.height="auto"},fnSetRowHeight:function(a,b){var c=d(a).children(":first");c=c.outerHeight()-c.height();if(d.browser.mozilla||d.browser.opera)a.style.height=b+"px";else d(a).children().height(b-c)},_fnConstruct:function(a){var b=this;if(typeof this.s.dt.oInstance.fnVersionCheck!="function"||this.s.dt.oInstance.fnVersionCheck("1.8.0")!==true)alert("FixedColumns "+FixedColumns.VERSION+" required DataTables 1.8.0 or later. Please upgrade your DataTables installation");else if(this.s.dt.oScroll.sX===
"")this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"FixedColumns is not needed (no x-scrolling in DataTables enabled), so no action will be taken. Use 'FixedHeader' for column fixing when scrolling is not enabled");else{this.s=d.extend(true,this.s,FixedColumns.defaults,a);this.dom.grid.dt=d(this.s.dt.nTable).parents("div.dataTables_scroll")[0];this.dom.scroller=d("div.dataTables_scrollBody",this.dom.grid.dt)[0];this._fnColCalc();this._fnGridSetup();d(this.dom.scroller).scroll(function(){if(b.s.iLeftColumns>
0)b.dom.grid.left.liner.scrollTop=b.dom.scroller.scrollTop;if(b.s.iRightColumns>0)b.dom.grid.right.liner.scrollTop=b.dom.scroller.scrollTop});if(b.s.iLeftColumns>0){d(b.dom.grid.left.liner).scroll(function(){b.dom.scroller.scrollTop=b.dom.grid.left.liner.scrollTop;if(b.s.iRightColumns>0)b.dom.grid.right.liner.scrollTop=b.dom.grid.left.liner.scrollTop});d(b.dom.grid.left.liner).bind("mousewheel",function(g){b.dom.scroller.scrollLeft-=g.originalEvent.wheelDeltaX/3})}if(b.s.iRightColumns>0){d(b.dom.grid.right.liner).scroll(function(){b.dom.scroller.scrollTop=
b.dom.grid.right.liner.scrollTop;if(b.s.iLeftColumns>0)b.dom.grid.left.liner.scrollTop=b.dom.grid.right.liner.scrollTop});d(b.dom.grid.right.liner).bind("mousewheel",function(g){b.dom.scroller.scrollLeft-=g.originalEvent.wheelDeltaX/3})}d(t).resize(function(){b._fnGridLayout.call(b)});var c=true;this.s.dt.aoDrawCallback=[{fn:function(){b._fnDraw.call(b,c);b._fnGridLayout(b);c=false},sName:"FixedColumns"}].concat(this.s.dt.aoDrawCallback);this._fnGridLayout();this.s.dt.oInstance.fnDraw(false)}},_fnColCalc:function(){var a=
this,b=d(this.dom.grid.dt).width(),c=0,g=0;this.s.aiInnerWidths=[];d("tbody>tr:eq(0)>td, tbody>tr:eq(0)>th",this.s.dt.nTable).each(function(h){a.s.aiInnerWidths.push(d(this).width());iWidth=d(this).outerWidth();a.s.aiOuterWidths.push(iWidth);if(h<a.s.iLeftColumns)c+=iWidth;if(a.s.iTableColumns-a.s.iRightColumns<=h)g+=iWidth});this.s.iLeftWidth=this.s.sLeftWidth=="fixed"?c:c/b*100;this.s.iRightWidth=this.s.sRightWidth=="fixed"?g:g/b*100},_fnGridSetup:function(){var a=this._fnDTOverflow(),b;this.dom.body=
this.s.dt.nTable;this.dom.header=this.s.dt.nTHead.parentNode;this.dom.header.parentNode.parentNode.style.position="relative";var c=d('<div class="DTFC_ScrollWrapper" style="position:relative; clear:both;"><div class="DTFC_LeftWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_LeftHeadWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div><div class="DTFC_LeftBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_LeftBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_LeftFootWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div></div><div class="DTFC_RightWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_RightHeadWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightHeadBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div><div class="DTFC_RightBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_RightBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_RightFootWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightFootBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div></div></div>')[0];
nLeft=c.childNodes[0];nRight=c.childNodes[1];this.dom.grid.dt.parentNode.insertBefore(c,this.dom.grid.dt);c.appendChild(this.dom.grid.dt);this.dom.grid.wrapper=c;if(this.s.iLeftColumns>0){this.dom.grid.left.wrapper=nLeft;this.dom.grid.left.head=nLeft.childNodes[0];this.dom.grid.left.body=nLeft.childNodes[1];this.dom.grid.left.liner=d("div.DTFC_LeftBodyLiner",c)[0];c.appendChild(nLeft)}if(this.s.iRightColumns>0){this.dom.grid.right.wrapper=nRight;this.dom.grid.right.head=nRight.childNodes[0];this.dom.grid.right.body=
nRight.childNodes[1];this.dom.grid.right.liner=d("div.DTFC_RightBodyLiner",c)[0];b=d("div.DTFC_RightHeadBlocker",c)[0];b.style.width=a.bar+"px";b.style.right=-a.bar+"px";this.dom.grid.right.headBlock=b;b=d("div.DTFC_RightFootBlocker",c)[0];b.style.width=a.bar+"px";b.style.right=-a.bar+"px";this.dom.grid.right.footBlock=b;c.appendChild(nRight)}if(this.s.dt.nTFoot){this.dom.footer=this.s.dt.nTFoot.parentNode;if(this.s.iLeftColumns>0)this.dom.grid.left.foot=nLeft.childNodes[2];if(this.s.iRightColumns>
0)this.dom.grid.right.foot=nRight.childNodes[2]}},_fnGridLayout:function(){var a=this.dom.grid,b=d(a.wrapper).width(),c=d(this.s.dt.nTable.parentNode).height(),g=d(this.s.dt.nTable.parentNode.parentNode).height(),h,e,f=this._fnDTOverflow();h=this.s.sLeftWidth=="fixed"?this.s.iLeftWidth:this.s.iLeftWidth/100*b;e=this.s.sRightWidth=="fixed"?this.s.iRightWidth:this.s.iRightWidth/100*b;if(f.x)c-=f.bar;a.wrapper.style.height=g+"px";if(this.s.iLeftColumns>0){a.left.wrapper.style.width=h+"px";a.left.wrapper.style.height=
g+"px";a.left.body.style.height=c+"px";if(a.left.foot)a.left.foot.style.top=(f.x?f.bar:0)+"px";a.left.liner.style.width=h+f.bar+"px";a.left.liner.style.height=c+"px"}if(this.s.iRightColumns>0){b=b-e;if(f.y)b-=f.bar;a.right.wrapper.style.width=e+"px";a.right.wrapper.style.left=b+"px";a.right.wrapper.style.height=g+"px";a.right.body.style.height=c+"px";if(a.right.foot)a.right.foot.style.top=(f.x?f.bar:0)+"px";a.right.liner.style.width=e+f.bar+"px";a.right.liner.style.height=c+"px";a.right.headBlock.style.display=
f.x?"block":"none";a.right.footBlock.style.display=f.x?"block":"none"}},_fnDTOverflow:function(){var a=this.s.dt.nTable,b=a.parentNode,c={x:false,y:false,bar:this.s.dt.oScroll.iBarWidth};if(a.offsetWidth>b.offsetWidth)c.x=true;if(a.offsetHeight>b.offsetHeight)c.y=true;return c},_fnDraw:function(a){this._fnCloneLeft(a);this._fnCloneRight(a);this.s.fnDrawCallback!==null&&this.s.fnDrawCallback.call(this,this.dom.clone.left,this.dom.clone.right);d(this).trigger("draw",{leftClone:this.dom.clone.left,rightClone:this.dom.clone.right})},
_fnCloneRight:function(a){if(!(this.s.iRightColumns<=0)){var b,c=[];for(b=this.s.iTableColumns-this.s.iRightColumns;b<this.s.iTableColumns;b++)c.push(b);this._fnClone(this.dom.clone.right,this.dom.grid.right,c,a)}},_fnCloneLeft:function(a){if(!(this.s.iLeftColumns<=0)){var b,c=[];for(b=0;b<this.s.iLeftColumns;b++)c.push(b);this._fnClone(this.dom.clone.left,this.dom.grid.left,c,a)}},_fnCopyLayout:function(a,b){for(var c=[],g=[],h=[],e=0,f=a.length;e<f;e++){var i=[];i.nTr=d(a[e].nTr).clone(true)[0];
for(var j=0,m=this.s.iTableColumns;j<m;j++)if(d.inArray(j,b)!==-1){var k=d.inArray(a[e][j].cell,h);if(k===-1){k=d(a[e][j].cell).clone(true)[0];g.push(k);h.push(a[e][j].cell);i.push({cell:k,unique:a[e][j].unique})}else i.push({cell:g[k],unique:a[e][j].unique})}c.push(i)}return c},_fnClone:function(a,b,c,g){var h=this,e,f,i,j,m,k,n;if(g){a.header!==null&&a.header.parentNode.removeChild(a.header);a.header=d(this.dom.header).clone(true)[0];a.header.className+=" DTFC_Cloned";a.header.style.width="100%";
b.head.appendChild(a.header);var l=this._fnCopyLayout(this.s.dt.aoHeader,c);j=d(">thead",a.header);j.empty();e=0;for(f=l.length;e<f;e++)j[0].appendChild(l[e].nTr);this.s.dt.oApi._fnDrawHead(this.s.dt,l,true)}else{l=this._fnCopyLayout(this.s.dt.aoHeader,c);var p=[];this.s.dt.oApi._fnDetectHeader(p,d(">thead",a.header)[0]);e=0;for(f=l.length;e<f;e++){i=0;for(j=l[e].length;i<j;i++){p[e][i].cell.className=l[e][i].cell.className;d("span.DataTables_sort_icon",p[e][i].cell).each(function(){this.className=
d("span.DataTables_sort_icon",l[e][i].cell)[0].className})}}}this._fnEqualiseHeights("thead",this.dom.header,a.header);this.s.sHeightMatch=="auto"&&d(">tbody>tr",h.dom.body).css("height","auto");if(a.body!==null){a.body.parentNode.removeChild(a.body);a.body=null}a.body=d(this.dom.body).clone(true)[0];a.body.className+=" DTFC_Cloned";a.body.style.paddingBottom=this.s.dt.oScroll.iBarWidth+"px";a.body.style.marginBottom=this.s.dt.oScroll.iBarWidth*2+"px";a.body.getAttribute("id")!==null&&a.body.removeAttribute("id");
d(">thead>tr",a.body).empty();d(">tfoot",a.body).remove();var q=d("tbody",a.body)[0];d(q).empty();if(this.s.dt.aiDisplay.length>0){f=d(">thead>tr",a.body)[0];for(n=0;n<c.length;n++){m=c[n];k=d(this.s.dt.aoColumns[m].nTh).clone(true)[0];k.innerHTML="";oStyle=k.style;oStyle.paddingTop="0";oStyle.paddingBottom="0";oStyle.borderTopWidth="0";oStyle.borderBottomWidth="0";oStyle.height=0;oStyle.width=h.s.aiInnerWidths[m]+"px";f.appendChild(k)}d(">tbody>tr",h.dom.body).each(function(o){var r=this.cloneNode(false);
o=h.s.dt.oFeatures.bServerSide===false?h.s.dt.aiDisplay[h.s.dt._iDisplayStart+o]:o;for(n=0;n<c.length;n++){var s=h.s.dt.oApi._fnGetTdNodes(h.s.dt,o);m=c[n];if(s.length>0){k=d(s[m]).clone(true)[0];r.appendChild(k)}}q.appendChild(r)})}else d(">tbody>tr",h.dom.body).each(function(){k=this.cloneNode(true);k.className+=" DTFC_NoData";d("td",k).html("");q.appendChild(k)});a.body.style.width="100%";a.body.style.margin="0";a.body.style.padding="0";g&&typeof this.s.dt.oScroller!="undefined"&&b.liner.appendChild(this.s.dt.oScroller.dom.force.cloneNode(true));
b.liner.appendChild(a.body);this._fnEqualiseHeights("tbody",h.dom.body,a.body);if(this.s.dt.nTFoot!==null){if(g){a.footer!==null&&a.footer.parentNode.removeChild(a.footer);a.footer=d(this.dom.footer).clone(true)[0];a.footer.className+=" DTFC_Cloned";a.footer.style.width="100%";b.foot.appendChild(a.footer);l=this._fnCopyLayout(this.s.dt.aoFooter,c);b=d(">tfoot",a.footer);b.empty();e=0;for(f=l.length;e<f;e++)b[0].appendChild(l[e].nTr);this.s.dt.oApi._fnDrawHead(this.s.dt,l,true)}else{l=this._fnCopyLayout(this.s.dt.aoFooter,
c);b=[];this.s.dt.oApi._fnDetectHeader(b,d(">tfoot",a.footer)[0]);e=0;for(f=l.length;e<f;e++){i=0;for(j=l[e].length;i<j;i++)b[e][i].cell.className=l[e][i].cell.className}}this._fnEqualiseHeights("tfoot",this.dom.footer,a.footer)}f=this.s.dt.oApi._fnGetUniqueThs(this.s.dt,d(">thead",a.header)[0]);d(f).each(function(o){m=c[o];this.style.width=h.s.aiInnerWidths[m]+"px"});if(h.s.dt.nTFoot!==null){f=this.s.dt.oApi._fnGetUniqueThs(this.s.dt,d(">tfoot",a.footer)[0]);d(f).each(function(o){m=c[o];this.style.width=
h.s.aiInnerWidths[m]+"px"})}},_fnGetTrNodes:function(a){for(var b=[],c=0,g=a.childNodes.length;c<g;c++)a.childNodes[c].nodeName.toUpperCase()=="TR"&&b.push(a.childNodes[c]);return b},_fnEqualiseHeights:function(a,b,c){if(!(this.s.sHeightMatch=="none"&&a!=="thead"&&a!=="tfoot")){var g,h,e=b.getElementsByTagName(a)[0];c=c.getElementsByTagName(a)[0];a=d(">"+a+">tr:eq(0)",b).children(":first");a=a.outerHeight()-a.height();e=this._fnGetTrNodes(e);var f=this._fnGetTrNodes(c);c=0;for(b=f.length;c<b;c++)if(this.s.sHeightMatch==
"semiauto"&&typeof e[c]._DTTC_iHeight!="undefined"&&e[c]._DTTC_iHeight!==null)d.browser.msie&&d(f[c]).children().height(e[c]._DTTC_iHeight-a);else{g=e[c].offsetHeight;h=f[c].offsetHeight;g=h>g?h:g;if(this.s.sHeightMatch=="semiauto")e[c]._DTTC_iHeight=g;if(d.browser.msie&&d.browser.version<8){d(f[c]).children().height(g-a);d(e[c]).children().height(g-a)}else{f[c].style.height=g+"px";e[c].style.height=g+"px"}}}}};FixedColumns.defaults={iLeftColumns:1,iRightColumns:0,fnDrawCallback:null,sLeftWidth:"fixed",
iLeftWidth:null,sRightWidth:"fixed",iRightWidth:null,sHeightMatch:"semiauto"};FixedColumns.prototype.CLASS="FixedColumns";FixedColumns.VERSION="2.5.0.dev"})(jQuery,window,document);
